# תיקון בעיית מחיקת שחקנים

## הבעיה
כאשר לוחצים על כפתור ה-X למחיקת שחקן ומאשרים את המחיקה, מופיעה הודעת הצלחה אבל השחקן לא נמחק בפועל מהשולחן.

## הסיבה
חסרה מדיניות RLS (Row Level Security) למחיקה (DELETE) בטבלת `table_players` ב-Supabase.

## הפתרון

### שלב 1: כנס ל-Supabase SQL Editor
1. פתח את [Supabase Dashboard](https://supabase.com/dashboard)
2. בחר את הפרויקט שלך
3. לחץ על **SQL Editor** בתפריט הצדדי

### שלב 2: הרץ את הסקריפט
1. העתק את כל התוכן מהקובץ `fix_delete_player_rls.sql`
2. הדבק אותו ב-SQL Editor
3. לחץ על **Run** (או Ctrl+Enter)

### שלב 3: בדוק שהתיקון עבד
אתה אמור לראות תוצאות שמראות את כל המדיניות של `table_players`:

```
schemaname | tablename      | policyname                                  | cmd
-----------+----------------+--------------------------------------------+------
public     | table_players  | Table owners and players can delete players | DELETE
public     | table_players  | ... (other policies)                        | ...
```

### שלב 4: בדוק באפליקציה
1. רענן את האפליקציה בדפדפן (F5)
2. נסה למחוק שחקן שוב
3. עכשיו זה אמור לעבוד!

## מה הסקריפט עושה?

הסקריפט מוסיף מדיניות DELETE שמאפשרת:
- **לבעלי השולחן** (table owner) למחוק כל שחקן
- **לשחקנים** למחוק את עצמם מהשולחן

זה בדיוק מה שצריך כדי לאפשר את פיצ'ר הסרת השחקנים!

## מידע נוסף

### מדיניות RLS
Row Level Security (RLS) הוא מנגנון אבטחה ב-PostgreSQL/Supabase שקובע מי יכול:
- לראות שורות (SELECT)
- להוסיף שורות (INSERT)
- לעדכן שורות (UPDATE)
- למחוק שורות (DELETE)

### למה זה חשוב?
בלי מדיניות DELETE, אף אחד לא יכול למחוק שורות מהטבלה - גם לא דרך הקוד שלך! Supabase חוסם את הפעולה ברמת המסד נתונים.

## אם עדיין לא עובד

1. פתח את ה-Console בדפדפן (F12)
2. נסה למחוק שחקן
3. חפש את השורה שמתחילה ב-`🗑️ Attempting to delete player:`
4. תעתיק את כל הלוגים ותשלח לי

---

**נכתב על ידי Claude Code** 🤖
